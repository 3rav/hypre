########################################################################
# Compiler and external dependences
########################################################################
include ../config/Makefile.config

CINCLUDES = ${INCLUDES} ${MPIINCLUDE}
CDEFS = -DHYPRE_TIMING -DHYPRE_FORTRAN
CXXDEFS = -DNOFEI -DHYPRE_TIMING -DMPICH_SKIP_MPICXX

C_COMPILE_FLAGS = \
 -I$(srcdir)\
 -I$(srcdir)/..\
 -I${HYPRE_BUILD_DIR}/include\
 ${CINCLUDES}\
 ${CDEFS}

CXX_COMPILE_FLAGS = \
 -I$(srcdir)\
 -I$(srcdir)/..\
 -I$(srcdir)/../FEI_mv/fei-base\
 -I${HYPRE_BUILD_DIR}/include\
 ${CINCLUDES}\
 ${CXXDEFS}

F77_COMPILE_FLAGS = \
 -I$(srcdir)\
 -I$(srcdir)/..\
 -I${HYPRE_BUILD_DIR}/include\
 ${CINCLUDES}

MPILIBFLAGS = ${MPILIBDIRS} ${MPILIBS} ${MPIFLAGS}
LAPACKLIBFLAGS = ${LAPACKLIBDIRS} ${LAPACKLIBS}
BLASLIBFLAGS = ${BLASLIBDIRS} ${BLASLIBS}
LIBFLAGS = ${LDFLAGS} ${LIBS}

LFLAGS =\
 -L${HYPRE_BUILD_DIR}/lib -Wl,-rpath,${HYPRE_BUILD_DIR}/lib -lHYPRE\
 ${MPILIBFLAGS}\
 ${LAPACKLIBFLAGS}\
 ${BLASLIBFLAGS}\
 ${LIBFLAGS}

########################################################################
# List of all programs to be compiled
########################################################################
ALLPROGS = ex1 ex2 ex3 ex4 ex5 ex5f ex6 ex7 ex8 ex9 ex10 ex11 ex12 ex12f \
           ex13 ex14 ex15 ex16
BIGINTPROGS = ex5big ex15big
FORTRANPROGS = ex5f ex12f
MAXDIMPROGS = ex17 ex18
COMPLEXPROGS = ex18comp

all: $(ALLPROGS)

default: all

bigint: $(BIGINTPROGS)

fortran: $(FORTRANPROGS)

maxdim: $(MAXDIMPROGS)

complex: $(COMPLEXPROGS)

########################################################################
# Example 1
########################################################################
ex1: ex1.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 2
########################################################################
ex2: ex2.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 3
########################################################################
ex3: ex3.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 4
########################################################################
ex4: ex4.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 5
########################################################################
ex5: ex5.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 5 with 64-bit integers
########################################################################
ex5big: ex5big.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 5 Fortran 77
########################################################################
ex5f: ex5f.o
	${LINK_FC} -o $@ $^ ${FFLAGS} ${LFLAGS}

########################################################################
# Example 6
########################################################################
ex6: ex6.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 7
########################################################################
ex7: ex7.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 8
########################################################################
ex8: ex8.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 9
########################################################################
ex9: ex9.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 10
########################################################################
ex10: ex10.o
	${LINK_CCX} -o $@ $^ ${CXXFLAGS} ${LFLAGS}

########################################################################
# Example 11
########################################################################
ex11: ex11.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 12
########################################################################
ex12: ex12.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 12 Fortran 77
########################################################################
ex12f: ex12f.o
	${LINK_FC} -o $@ $^ ${FFLAGS} ${LFLAGS}

########################################################################
# Example 13
########################################################################
ex13: ex13.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 14
########################################################################
ex14: ex14.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 15
########################################################################
ex15: ex15.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 15 with 64-bit integers
########################################################################
ex15big: ex15big.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 16
########################################################################
ex16: ex16.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 17
########################################################################
ex17: ex17.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 18
########################################################################
ex18: ex18.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Example 18 (complex)
########################################################################
ex18comp: ex18comp.o
	${LINK_CC} -o $@ $^ ${CFLAGS} ${LFLAGS}

########################################################################
# Clean up
########################################################################
clean:
	rm -f $(ALLPROGS:=.o)
	rm -f $(BIGINTPROGS:=.o)
	rm -f $(FORTRANPROGS:=.o)
	rm -f $(MAXDIMPROGS:=.o)
	rm -f $(COMPLEXPROGS:=.o)
	cd vis; make clean
distclean: clean
	rm -f $(ALLPROGS) $(ALLPROGS:=*~)
	rm -f $(BIGINTPROGS) $(BIGINTPROGS:=*~)
	rm -f $(FORTRANLPROGS) $(FORTRANPROGS:=*~)
	rm -f $(MAXDIMPROGS) $(MAXDIMPROGS:=*~)
	rm -f $(COMPLEXPROGS) $(COMPLEXPROGS:=*~)
	rm -fr README*
