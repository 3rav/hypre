\chapter{Finite Element Interface}
\label{chapter-FEI}

The finite element interface (FEI) defines a linear solver interface 
for finite element applications.  For information on how to use this
interface, see \cite{FEI-ref}.  
This chapter describes the iterative methods and 
preconditioners in the \hypre{} implementation
of this interface.

Solving a linear system from a finite element problem consists of
four steps in the FEI:
\begin{enumerate}
\item Initialize the structure of the finite-element data,
      including loading the element connectivity data
\item Load the element or super-element stiffness matrices and forcing terms
\item Set solver parameters and solve the linear system
\item Retrieve the solution to the linear system
\end{enumerate}

Parameters to the \hypre{} solvers are specified by calling
\begin{display}
\begin{verbatim}
void FEI_parameters(int sysHandle, int numParams, char **paramStrings);
\end{verbatim}
\end{display}
where {\tt sysHandle} is an identifier for the linear system being solved,
{\tt numParams} is the number of parameter strings, and {\tt paramStrings} is
an array of null-terminated strings with the format: 
``{\em parameter\_name value}''.
For example, setting the preconditioner can be accomplished by:
\begin{display}
\begin{verbatim}
char **paramStrings[1];
paramStrings[0] = (char *) malloc(64*sizeof(char));
strcpy(paramStrings[0], "preconditioner parasails");
FEI_parameters(sysHandle, 1, paramStrings);
\end{verbatim}
\end{display}
All possible parameters are listed in section \ref{sec:fei-param} below.


A linear system is then solved by calling 
\begin{display}
\begin{verbatim}
void FEI_iterateToSolve(int sysHandle);
\end{verbatim}
\end{display}

\section{Iterative methods and preconditioners available}

\subsection{Iterative methods}

\begin{enumerate}
\item conjugate gradient (CG)
\item generalized minimal residual (GMRES) methods
%\item SuperLU direct solver
%\item SuperLU direct solver with iterative refinement
%\item Y12M direct solver
\end{enumerate}

\subsection{Preconditioners}

\begin{enumerate}
\item diagonal
\item parallel incomplete LU with threshold (PILUT)
\item parallel algebraic multigrid (BoomerAMG)
\item parallel sparse approximate inverse (ParaSails)
\end{enumerate}

%Capabilities under development are :
%\begin{enumerate}
%\item to form and solve a reduced linear system (in view of constraints), and
%\item a link to the ML's parallel smoothed aggregation method.
%\end{enumerate}

\section{Parameters}
\label{sec:fei-param}

\begin{description}
\item[solver XXX] - where XXX specifies one of {\sf cg}, {\sf gmres},
                    {\sf superlu}, or {\sf superlux}.  The default is {\sf gmres}.
\item[preconditioner XXX] - where XXX is one of {\sf diagonal}, {\sf pilut},
                    {\sf parasails}, or {\sf boomeramg}. The default 
                    is {\sf diagonal}.
\item[gmres-dim XXX] - where XXX is an integer specifying the value of m in
                       restarted GMRES(m).  The default value is 50.
\item[maxIterations XXX] - where XXX is an integer specifying the maximum number
                           of iterations permitted for CG or GMRES.
                           The default value is 1000.
\item[tolerance XXX] - where XXX is a floating point number specifying the 
                       termination criterion for CG or GMRES.  The default value is
                       1.0E-10.
\item[pilut-row-size XXX] - where XXX is an integer specifying the maximum
                       number of nonzeros kept in the formation of imcomplete L
                       and U).  If this is not called, a value will be selected
                       based on the sparsity of the matrix.
\item[pilut-drop-tol XXX] - where XXX is a floating point number specifying the 
                       threshold to drop small entries in L and U.  The default
                       value is 0.0.
\item[superlu-ordering XXX] - where XXX specifies on of {\sf natural} or
                       {\sf mmd} (minimum degree ordering).  This ordering
                       is used to minimize the number of nonzeros generated
                       in the LU decomposition.  The default is natural ordering.
\item[superlu-scale XXX] - where XXX specifies on of {\sf y} (perform row
                       and column scalings before decomposition) or {\sf n}.
                       The default is no scaling.
\item[amg-coarsen-type XXX] - where XXX specifies on of {\sf falgout},
                       {\sf ruge}, or {\sf default} coarsening for BOOMERAMG.
\item[amg-num-sweeps XXX] - where XXX is an integer specifying the number of
                       pre- and post-smoothing at each level of BOOMERAMG.
                       The default is one pre- and one post-smoothings.
\item[amg-relax-type XXX] - where XXX is one of {\sf jacobi} (Damped Jacobi),
                       {\sf gs-slow} (sequential Gauss-Seidel), {\sf gs-fast}
                       (Gauss-Seidel on interior nodes), {\sf hybrid},
                       or {\sf direct}. The default is {\sf hybrid}.
\item[amg-relax-weight XXX] - where XXX is a floating point number between 0 and 1
                       specifying the damping factor for BOOMERAMG's damped
                       Jacobi smoother.  The default value is 0.5.
\item[amg-strong-threshold XXX] - where XXX is a floating point number between 0 
                       and 1 specifying the threshold used to determine
                       strong coupling in BOOMERAMG's coasening.  The default 
                       value is 0.25.
\item[parasails-threshold XXX] - where XXX is a floating point number between 0 
                       and 1 specifying the threshold used to prune small entries
                       in setting up the sparse approximate inverse.  The default
                       value is 0.0.
\item[parasails-nlevels XXX] - where XXX is an integer larger than 0 specifying 
                       the desired sparsity of the approximate inverse.  The
                       default value is 1.
\end{description}


%\section{HYPRE-FEI Extensions}
%
%In order to support the reduced system formulation for applications
%with slide surface constraints,
%two additional functions are provided via HYPRE-FEI
%on top of the base FEI specification :
%
%\begin{description}
%\item[loadSlaveList(int,int*)] - this function is used to load information
%                        about which unknowns are the slave nodes in the
%                        slide surfaces.  This information is useful for
%                        the construction of reduced linear system.
%\item[buildReducedSystem() ] - this function can be called to reduced a linear
%                        system with constraints to a better-conditioned reduced
%                        form.
%\end{description}

%\section{HYPRE-FEI Comments and Contacts}
%
%Any comments about this HYPRE-FEI interface can be directed to Charles Tong
%(X23411 or chtong@llnl.gov) or Edmond Chow (X31915 or chow8@llnl.gov).

