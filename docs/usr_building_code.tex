%==========================================================================
\chapter{Building the Code}
\section{Code configuration}

To automatically generate machine specific makefiles, type
\kbd{configure} in the \file{linear_solvers} directory.  The configure
script is a portable script generated by GNU Autoconf.  It runs a
series of tests to determine characteristics of the machine on which
it is running, and it uses the results of the these tests to produce
the machine specific makefiles, called `Makefile', from template files
called `Makefile.in' in each directory.  Once the makefiles are
produced you can run make as you would with any other makefile.

This configure script primarily does the following things:
\begin{itemize}
\item selects a compiler
\item provides either optimization or debugging options for the compiler
\item finds the headers and libraries for MPI
\end{itemize}

The configure script has some command-line options that can give you
some control over the choices it will make.  You can type
\verb+configure --help+
to see the list of all of the command-line options to configure. This is
the best resource for information on configure options.  Below is some
additional helpful information.


\begin{description}

\item[Compilers] If you want to choose a compiler then is it recommended
that you choose all (C, C++, Fortran) compilers.

\item[Compiler Flags] To choose optimization or debug, use
\verb+--enable-opt+ (default) or \verb+--enable-debug+.
For other compiler flags use the \verb+--with-CFLAGS+ option.  

\item[BLAS] If you want the optimum BLAS for the platform,
no configure option for it needs to be specified.
To use the BLAS packaged with {\slshape hypre},
specify \verb+--$with-HYPREblas+.
To specify another BLAS library available on a
platform, use \verb+with-BLAS=+{\itshape pathname} or
\verb+--with-BLAS=+{\itshape link list}.

\end{description}

Configure automatically generates a file 
\verb+HYPRE_config.h+ that includes all the
header files found to be necessary by configure.  This file may be used
to see how a compiled version of the library was configured and may also
be included by the user in his/her own code.

\section{Linking into another program}

A program linking with {\slshape hypre} must be compiled with
\verb+-I$HYPRE_DIR/hypre/include+ and linked with
\verb+-L$HYPRE_DIR/hypre/lib -l+{\itshape hypre library name}... 
\verb+-l+{\itshape hypre library name}.
This assumes that {\slshape hypre} has been
successfully configured and compiled in directory \verb+$HYPRE_DIR+
on the platfrom, so that \verb+$HYPRE_DIR/hypre/lib+
and \verb+$HYPRE_DIR/hypre/include+ are correctly filled.

When using a formal {\slshape hypre} installation, \verb+$HYPRE_DIR+ is
\verb+/usr/apps/hypre+.
When using a "hacked" installation, the hacker sets \verb+$HYPRE_DIR+,
and must link with it in the code calling {\slshape hypre}. 
