# (c) 1997   The Regents of the University of California
#
# See the file COPYRIGHT_and_DISCLAIMER for a complete copyright
# notice, contact person, and disclaimer.
#
# $Revision$
#EHEADER***********************************************************************

include ../config/Makefile.config

C_COMPILE_FLAGS=@CFLAGS@
CINCLUDES=@INCLUDES@ @MPIINCLUDE@
CDEFS = @TIMERDEFS@ -DHYPRE_TIMING

CFLAGS =\
   -I..\
   -I$(srcdir)/..\
   -I$(srcdir)\
   ${C_COMPILE_FLAGS}\
   ${CINCLUDES}\
   ${CDEFS}

##################################################################
# HEADER Files
##################################################################
HEADERS =\
 f2c.h\
 hypre_blas.h\
 hypre_lapack.h\
 amg_linklist.h\
 exchange_data.h\
 fortran.h\
 general.h\
 hypre_memory.h\
 hypre_smp_forloop.h\
 HYPRE_utilities.h\
 mpistubs.h\
 threading.h\
 thread_mpistubs.h\
 timing.h\
 umalloc_local.h\
 utilities.h

##################################################################
# Utilities Files
##################################################################
UTILITIES_FILES =\
 amg_linklist.c\
 binsearch.c\
 exchange_data.c\
 hypre_memory.c\
 hypre_qsort.c\
 memory_dmalloc.c\
 mpistubs.c\
 qsplit.c\
 random.c\
 threading.c\
 thread_mpistubs.c\
 timer.c\
 timing.c\
 umalloc_local.c

##################################################################
# BLAS Files
##################################################################
BLAS_FILES=
@BLASNEEDED@BLAS_FILES=\
@BLASNEEDED@blas_utils.c\
@BLASNEEDED@dasum.c\
@BLASNEEDED@daxpy.c\
@BLASNEEDED@dcopy.c\
@BLASNEEDED@ddot.c\
@BLASNEEDED@dgemm.c\
@BLASNEEDED@dgemv.c\
@BLASNEEDED@dger.c\
@BLASNEEDED@dnrm2.c\
@BLASNEEDED@drot.c\
@BLASNEEDED@dscal.c\
@BLASNEEDED@dswap.c\
@BLASNEEDED@dsymm.c\
@BLASNEEDED@dsymv.c\
@BLASNEEDED@dsyr2.c\
@BLASNEEDED@dsyr2k.c\
@BLASNEEDED@dsyrk.c\
@BLASNEEDED@dtrmm.c\
@BLASNEEDED@dtrmv.c\
@BLASNEEDED@dtrsm.c\
@BLASNEEDED@dtrsv.c\
@BLASNEEDED@idamax.c

##################################################################
# LAPACK Files
##################################################################
LAPACK_FILES =
@LAPACKNEEDED@LAPACK_FILES=\
@LAPACKNEEDED@dbdsqr.c\
@LAPACKNEEDED@dgebd2.c\
@LAPACKNEEDED@dgebrd.c\
@LAPACKNEEDED@dgelq2.c\
@LAPACKNEEDED@dgelqf.c\
@LAPACKNEEDED@dgels.c\
@LAPACKNEEDED@dgeqr2.c\
@LAPACKNEEDED@dgeqrf.c\
@LAPACKNEEDED@dgesvd.c\
@LAPACKNEEDED@dlabad.c\
@LAPACKNEEDED@dlabrd.c\
@LAPACKNEEDED@dlacpy.c\
@LAPACKNEEDED@dlae2.c\
@LAPACKNEEDED@dlaev2.c\
@LAPACKNEEDED@dlamch.c\
@LAPACKNEEDED@dlange.c\
@LAPACKNEEDED@dlanst.c\
@LAPACKNEEDED@dlansy.c\
@LAPACKNEEDED@dlapy2.c\
@LAPACKNEEDED@dlarfb.c\
@LAPACKNEEDED@dlarf.c\
@LAPACKNEEDED@dlarfg.c\
@LAPACKNEEDED@dlarft.c\
@LAPACKNEEDED@dlartg.c\
@LAPACKNEEDED@dlas2.c\
@LAPACKNEEDED@dlascl.c\
@LAPACKNEEDED@dlaset.c\
@LAPACKNEEDED@dlasq1.c\
@LAPACKNEEDED@dlasq2.c\
@LAPACKNEEDED@dlasq3.c\
@LAPACKNEEDED@dlasq4.c\
@LAPACKNEEDED@dlasq5.c\
@LAPACKNEEDED@dlasq6.c\
@LAPACKNEEDED@dlasr.c\
@LAPACKNEEDED@dlasrt.c\
@LAPACKNEEDED@dlassq.c\
@LAPACKNEEDED@dlasv2.c\
@LAPACKNEEDED@dlatrd.c\
@LAPACKNEEDED@dorg2l.c\
@LAPACKNEEDED@dorg2r.c\
@LAPACKNEEDED@dorgbr.c\
@LAPACKNEEDED@dorgl2.c\
@LAPACKNEEDED@dorglq.c\
@LAPACKNEEDED@dorgql.c\
@LAPACKNEEDED@dorgqr.c\
@LAPACKNEEDED@dorgtr.c\
@LAPACKNEEDED@dorm2r.c\
@LAPACKNEEDED@dormbr.c\
@LAPACKNEEDED@dorml2.c\
@LAPACKNEEDED@dormlq.c\
@LAPACKNEEDED@dormqr.c\
@LAPACKNEEDED@dpotf2.c\
@LAPACKNEEDED@dpotrf.c\
@LAPACKNEEDED@dpotrs.c\
@LAPACKNEEDED@dsteqr.c\
@LAPACKNEEDED@dsterf.c\
@LAPACKNEEDED@dsyev.c\
@LAPACKNEEDED@dsygs2.c\
@LAPACKNEEDED@dsygst.c\
@LAPACKNEEDED@dsygv.c\
@LAPACKNEEDED@dsytd2.c\
@LAPACKNEEDED@dsytrd.c\
@LAPACKNEEDED@ieeeck.c\
@LAPACKNEEDED@ilaenv.c\
@LAPACKNEEDED@lapack_utils.c\
@LAPACKNEEDED@lsame.c\
@LAPACKNEEDED@xerbla.c

FILES =\
 ${UTILITIES_FILES}\
 ${BLAS_FILES} \
 ${LAPACK_FILES}

OBJS = ${FILES:.c=.o}

##################################################################
# Targets
##################################################################

all: libHYPRE_utilities.a 

install: all
	@cp -f $(srcdir)/HYPRE_*.h $$HYPRE_INSTALL_DIR/include/.
	@cp -f $(srcdir)/utilities.h $$HYPRE_INSTALL_DIR/include/.
	@cp -f libHYPRE_*.a $$HYPRE_INSTALL_DIR/lib/.

clean:
	@rm -f *.o
	@rm -f ${BLAS_FILES}
	@rm -f ${LAPACK_FILES}

veryclean: clean
	@rm -f libHYPRE_*.a


##################################################################
# Rules
##################################################################
 
libHYPRE_utilities.a: ${OBJS} 
	@echo  "Building $@ ... "
	ar -rcu $@ ${OBJS}
	${RANLIB} $@

${OBJS}: ${HEADERS}

timer.o: timer.c
	${CC} -D_POSIX_SOURCE -o $@ -c ${CFLAGS} $<
