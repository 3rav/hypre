# (c) 1997   The Regents of the University of California
#
# See the file COPYRIGHT_and_DISCLAIMER for a complete copyright
# notice, contact person, and disclaimer.
#
# $Revision$
#EHEADER***********************************************************************

include ../config/Makefile.config

C_COMPILE_FLAGS=@CFLAGS@
CINCLUDES=@INCLUDES@ @MPIINCLUDE@
CDEFS = @TIMERDEFS@ -DHYPRE_TIMING

CFLAGS =\
   -I..\
   -I$(srcdir)/..\
   -I$(srcdir)\
   ${C_COMPILE_FLAGS}\
   ${CINCLUDES}\
   ${CDEFS}

##################################################################
# Lapack Object Files
##################################################################
LAPACK_HEADERS = 
@LAPACK_NEEDED@LAPACK_HEADERS = hypre_lapack.h f2c.h

LAPACK_FILES =
@LAPACKNEEDED@LAPACK_FILES = \
@LAPACKNEEDED@dbdsqr.o\
@LAPACKNEEDED@dgebd2.o\
@LAPACKNEEDED@dgebrd.o\
@LAPACKNEEDED@dgelq2.o\
@LAPACKNEEDED@dgelqf.o\
@LAPACKNEEDED@dgels.o\
@LAPACKNEEDED@dgeqr2.o\
@LAPACKNEEDED@dgeqrf.o\
@LAPACKNEEDED@dgesvd.o\
@LAPACKNEEDED@dlabad.o\
@LAPACKNEEDED@dlabrd.o\
@LAPACKNEEDED@dlacpy.o\
@LAPACKNEEDED@dlae2.o\
@LAPACKNEEDED@dlaev2.o\
@LAPACKNEEDED@dlamch.o\
@LAPACKNEEDED@dlange.o\
@LAPACKNEEDED@dlanst.o\
@LAPACKNEEDED@dlansy.o\
@LAPACKNEEDED@dlapy2.o\
@LAPACKNEEDED@dlarfb.o\
@LAPACKNEEDED@dlarf.o\
@LAPACKNEEDED@dlarfg.o\
@LAPACKNEEDED@dlarft.o\
@LAPACKNEEDED@dlartg.o\
@LAPACKNEEDED@dlas2.o\
@LAPACKNEEDED@dlascl.o\
@LAPACKNEEDED@dlaset.o\
@LAPACKNEEDED@dlasq1.o\
@LAPACKNEEDED@dlasq2.o\
@LAPACKNEEDED@dlasq3.o\
@LAPACKNEEDED@dlasq4.o\
@LAPACKNEEDED@dlasq5.o\
@LAPACKNEEDED@dlasq6.o\
@LAPACKNEEDED@dlasr.o\
@LAPACKNEEDED@dlasrt.o\
@LAPACKNEEDED@dlassq.o\
@LAPACKNEEDED@dlasv2.o\
@LAPACKNEEDED@dlatrd.o\
@LAPACKNEEDED@dorg2l.o\
@LAPACKNEEDED@dorg2r.o\
@LAPACKNEEDED@dorgbr.o\
@LAPACKNEEDED@dorgl2.o\
@LAPACKNEEDED@dorglq.o\
@LAPACKNEEDED@dorgql.o\
@LAPACKNEEDED@dorgqr.o\
@LAPACKNEEDED@dorgtr.o\
@LAPACKNEEDED@dorm2r.o\
@LAPACKNEEDED@dormbr.o\
@LAPACKNEEDED@dorml2.o\
@LAPACKNEEDED@dormlq.o\
@LAPACKNEEDED@dormqr.o\
@LAPACKNEEDED@dpotf2.o\
@LAPACKNEEDED@dpotrf.o\
@LAPACKNEEDED@dpotrs.o\
@LAPACKNEEDED@dsteqr.o\
@LAPACKNEEDED@dsterf.o\
@LAPACKNEEDED@dsyev.o\
@LAPACKNEEDED@dsygs2.o\
@LAPACKNEEDED@dsygst.o\
@LAPACKNEEDED@dsygv.o\
@LAPACKNEEDED@dsytd2.o\
@LAPACKNEEDED@dsytrd.o\
@LAPACKNEEDED@ieeeck.o\
@LAPACKNEEDED@ilaenv.o\
@LAPACKNEEDED@lapack_utils.o\
@LAPACKNEEDED@lsame.o\
@LAPACKNEEDED@xerbla.o

LAPACK_INFO = ${LAPACK_HEADERS} ${LAPACK_FILES}

##################################################################
# Blas Object Files
##################################################################
BLAS_HEADERS = 
@BLAS_NEEDED@BLAS_HEADERS = hypre_blas.h f2c.h

BLAS_FILES =
@BLASNEEDED@BLAS_FILES = \
@BLASNEEDED@blas_utils.o\
@BLASNEEDED@dasum.o\
@BLASNEEDED@daxpy.o\
@BLASNEEDED@dcopy.o\
@BLASNEEDED@ddot.o\
@BLASNEEDED@dgemm.o\
@BLASNEEDED@dgemv.o\
@BLASNEEDED@dger.o\
@BLASNEEDED@dnrm2.o\
@BLASNEEDED@drot.o\
@BLASNEEDED@dscal.o\
@BLASNEEDED@dswap.o\
@BLASNEEDED@dsymm.o\
@BLASNEEDED@dsymv.o\
@BLASNEEDED@dsyr2.o\
@BLASNEEDED@dsyr2k.o\
@BLASNEEDED@dsyrk.o\
@BLASNEEDED@dtrmm.o\
@BLASNEEDED@dtrmv.o\
@BLASNEEDED@dtrsm.o\
@BLASNEEDED@dtrsv.o\
@BLASNEEDED@idamax.o

BLAS_INFO = ${BLAS_HEADERS} ${BLAS_FILES}

##################################################################
# Utilities Header Files
##################################################################
HEADERS =\
 amg_linklist.h\
 exchange_data.h\
 fortran.h\
 general.h\
 hypre_memory.h\
 hypre_smp_forloop.h\
 HYPRE_utilities.h\
 mpistubs.h\
 threading.h\
 thread_mpistubs.h\
 timing.h\
 umalloc_local.h\
 utilities.h

##################################################################
# Utilities Files
##################################################################
FILES =\
 amg_linklist.c\
 binsearch.c\
 exchange_data.c\
 hypre_memory.c\
 hypre_qsort.c\
 memory_dmalloc.c\
 mpistubs.c\
 qsplit.c\
 random.c\
 threading.c\
 thread_mpistubs.c\
 timer.c\
 timing.c\
 umalloc_local.c

OBJS = ${FILES:.c=.o}

##################################################################
# Targets
##################################################################

all: libHYPRE_utilities.a 

install: all
	@cp -f $(srcdir)/HYPRE_*.h $$HYPRE_INSTALL_DIR/include/.
	@cp -f $(srcdir)/utilities.h $$HYPRE_INSTALL_DIR/include/.
	@cp -f libHYPRE_*.a $$HYPRE_INSTALL_DIR/lib/.

clean:
	@rm -f *.o

veryclean: clean
	@rm -f libHYPRE_*.a
	@rm -f Makefile


##################################################################
# Rules
##################################################################
 
libHYPRE_utilities.a: ${OBJS}
	@echo  "Building $@ ... "
	ar -rcu $@ ${OBJS} ${LAPACK_INFO} ${BLAS_INFO}
	${RANLIB} $@

${OBJS}: ${HEADERS}

timer.o: timer.c
	${CC} -D_POSIX_SOURCE -o $@ -c ${CFLAGS} $<
