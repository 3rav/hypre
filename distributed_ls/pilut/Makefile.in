
all: lib_HYPRE_DistributedMatrixPilutSolver.a

install:all
	@cp -f HYPRE_*.h $$HYPRE_INSTALL_DIR/include/.
	@cp -f lib_HYPRE_*.a $$HYPRE_INSTALL_DIR/lib/.

MPI_INCLUDES = -I/usr/local/mpi/mpich/include
MPI_LIBDIR   = -L/usr/local/mpi/mpich/lib/solaris/ch_p4/
MPI_LIBS     = -lmpi -lnsl -lsocket -lgen
MPIRUN       = mpirun -np 4

#PETSc; not used here, but used by objects called from here 
PETSC_INCLUDES = -I${PETSC_DIR}/include
# General
HYPRE_INCLUDES = -I../.. -I../../utilities -I/home/casc/include
INCLUDES = $(HYPRE_INCLUDES) $(MPI_INCLUDES) $(PETSC_INCLUDES)
LIBDIR   = $(MPI_LIBDIR)
LIBS     = -L. -lHYPREpilut -lm $(MPI_LIBS) $(OTHER_LIBS)

# Debugging via asserts
DEBUGFLAGS = -DHYPRE_DEBUG -DHYPRE_MEMORY_CHECK #-DNDEBUG #-DTIME
CFLAGS = $(OPTIMIZATION) $(INCLUDES) $(DEBUGFLAGS)

HYPREFILES =\
 HYPRE_DistributedMatrixPilutSolver.c

LOCALFILES = debug.c comm.c parutil.c serilut.c parilut.c util.c qsort.c\
       qsort_si.c trifactor.c ilut.c pblas1.c 

FILES = $(HYPREFILES) $(LOCALFILES)

HEADERS = \
       DistributedMatrixPilutSolver.h const.h ilu.h macros.h struct.h

OBJS = ${FILES:.c=.o}

${OBJS}: ${HEADERS}

#include site-specific information
include ../../bmakes/Makefile


##################################################################
# Main rules
##################################################################

lib_HYPRE_DistributedMatrixPilutSolver.a: ${PROTOS} ${OBJS}
	@echo "Building $@ ... "
	ar -rcu $@ ${OBJS}
	@RANLIB@ $@

