#BHEADER***********************************************************************
# (c) 1999   The Regents of the University of California
#
# See the file COPYRIGHT_and_DISCLAIMER for a complete copyright
# notice, contact person, and disclaimer.
#
# $Revision$
#EHEADER***********************************************************************


.SUFFIXES: .cc .c .f .o

all: lib

install:all

CXX = @CXX@

CXXFLAGS = \
  @MPIINCLUDE@\
 -I../fei-isis\
 -I../isis-mv\
 -I../../IJ_matrix_vector\
 -I../../utilities\
 -I../../parcsr_matrix_vector\
 -I../../parcsr_linear_solvers\
 -I../../seq_matrix_vector\
 -I../..

MPILIBFLAGS = @MPILIBDIRS@ @MPILIBS@ @MPIFLAGS@
LIBFLAGS = @LIBDIRS@ @LIBS@
LDLIBFLAGS = @LDLIBDIRS@ @LDLIBS@

LFLAGS =\
 -L.\
 -L../fei-isis/src\
 -L../isis-mv\
 -L../../IJ_matrix_vector\
 -L../../utilities\
 -L../../parcsr_matrix_vector\
 -L../../parcsr_linear_solvers\
 -L../../seq_matrix_vector\
 -lHYPRE_FEI\
 -lHYPRE_FEI_base\
 -lHYPRE_FEI_isismv\
 -lHYPRE_IJ_mv\
 -lHYPRE_parcsr_ls\
 -lHYPRE_parcsr_mv\
 -lHYPRE_seq_mv\
 -lHYPRE_utilities\
 ${MPILIBFLAGS} ${LIBFLAGS} ${LDLIBFLAGS}\
 -lm


HEADERS =\
 HYPRE_SLE.h
 
HYPREFILES =\
 HYPRE_SLE.cc

LOCALFILES =\
 driver.cc


FILES = $(HYPREFILES)


OBJS = ${FILES:.c=.o} ${FILES:.cc=.o}

${OBJS}: ${HEADERS}


##################################################################
# Main rules
##################################################################

driver: driver.o libHYPRE_FEI.a
	@echo  "Linking" $@ "... "
	${CXX} -o $@ driver.o ${LFLAGS}

lib: ${OBJS}
	@echo  "Building $@ ... "
	@echo  "Building ${OBJS} ... "
	@ar -rcu libHYPRE_FEI.a ${OBJS}
	@ranlib libHYPRE_FEI.a 

##################################################################
# Targets
##################################################################

clean:
	@rm -f *.o *.dxx

veryclean: clean
	@rm -f libHYPRE_*.a



##################################################################
# Generic rules
##################################################################

.cc.o:
	${CXX} -o $@ -c ${CXXFLAGS} $<


