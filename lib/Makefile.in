#BHEADER***********************************************************************
# (c) 2000   The Regents of the University of California
#
# See the file COPYRIGHT_and_DISCLAIMER for a complete copyright
# notice, contact person, and disclaimer.
#
# $Revision$
#EHEADER***********************************************************************

include ../config/Makefile.config

HYPRE_SRC_DIRS =\
 FEI_mv/SuperLU\
 FEI_mv/fei-hypre\
 FEI_mv/femli/lib\
 IJ_mv\
 distributed_ls/Euclid\
 distributed_ls/ParaSails\
 distributed_ls/pilut\
 distributed_matrix\
 krylov\
 matrix_matrix\
 eigensolvers/lib\
 parcsr_ls\
 parcsr_mv\
 seq_mv\
 sstruct_ls\
 sstruct_mv\
 struct_ls\
 struct_mv\
 utilities
 
ifdef BLASNEEDED
  BLASFILES =\
     dasum.o\
     daxpy.o\
     dcopy.o\
     ddot.o\
     dgemm.o\
     dgemv.o\
     dger.o\
     dnrm2.o\
     drot.o\
     dscal.o\
     dsymv.o\
     dsyr2.o\
     dsyr2k.o\
     dsyrk.o\
     dtrmm.o\
     dtrmv.o\
     dtrsm.o\
     dtrsv.o\
     idamax.o\
     blas_utils.o
else
  BLASFILES=
endif


ifdef LAPACKNEEDED
  LAPACKFILES = \
     dbdsqr.o\
     dgebd2.o\
     dgebrd.o\
     dgelq2.o\
     dgelqf.o\
     dgels.o\
     dgeqr2.o\
     dgeqrf.o\
     dgesvd.o\
     dlabad.o\
     dlabrd.o\
     dlacpy.o\
     dlae2.o\
     dlaev2.o\
     dlamch.o\
     dlange.o\
     dlanst.o\
     dlansy.o\
     dlapy2.o\
     dlarf.o\
     dlarfb.o\
     dlarfg.o\
     dlarft.o\
     dlartg.o\
     dlas2.o\
     dlascl.o\
     dlaset.o\
     dlasq1.o\
     dlasq2.o\
     dlasq3.o\
     dlasq4.o\
     dlasq5.o\
     dlasq6.o\
     dlasr.o\
     dlasrt.o\
     dlassq.o\
     dlasv2.o\
     dlatrd.o\
     dorg2l.o\
     dorg2r.o\
     dorgbr.o\
     dorgl2.o\
     dorglq.o\
     dorgql.o\
     dorgqr.o\
     dorgtr.o\
     dorm2r.o\
     dormbr.o\
     dorml2.o\
     dormlq.o\
     dormqr.o\
     dpotf2.o\
     dpotrf.o\
     dpotrs.o\
     dsteqr.o\
     dsterf.o\
     dsyev.o\
     dsygs2.o\
     dsygst.o\
     dsygv.o\
     dsytd2.o\
     dsytrd.o\
     ieeeck.o\
     ilaenv.o\
     lapack_utils.o\
     lsame.o\
     xerbla.o
else
  LAPACKFILES=
endif

SUPERLUFILES = \
 colamd.o\
 dcolumn_bmod.o\
 dcolumn_dfs.o\
 dcopy_to_ucol.o\
 dgscon.o\
 dgsequ.o\
 dgsrfs.o\
 dgssv.o\
 dgssvx.o\
 dgstrf.o\
 dgstrs.o\
 dlacon.o\
 dlangs.o\
 dlaqgs.o\
 dmemory.o\
 dpanel_bmod.o\
 dpanel_dfs.o\
 dpivotL.o\
 dpivotgrowth.o\
 dpruneL.o\
 dreadhb.o\
 dsnode_bmod.o\
 dsnode_dfs.o\
 dsp_blas2.o\
 dsp_blas3.o\
 dutil.o\
 get_perm_c.o\
 mmd.o\
 relax_snode.o\
 sp_coletree.o\
 sp_ienv.o\
 sp_preorder.o\
 superlu_memory.o\
 superlu_timer.o\
 superlu_util.o

MOSTFILES = \
 bicgs.o\
 bicgstabl.o\
 FEI_HYPRE_Impl.o\
 HYPRE_LSC_aux.o\
 HYPRE_LSI_Dsuperlu.o\
 HYPRE_LSI_UZAWA.o\
 HYPRE_LSI_blkprec.o\
 HYPRE_LSI_ddict.o\
 HYPRE_LSI_ddilut.o\
 HYPRE_LSI_ml.o\
 HYPRE_LSI_mli.o\
 HYPRE_LSI_poly.o\
 HYPRE_LSI_schwarz.o\
 HYPRE_LinSysCore.o\
 HYPRE_SlideReduction.o\
 HYPRE_parcsr_TFQmr.o\
 HYPRE_parcsr_bicgs.o\
 HYPRE_parcsr_bicgstabl.o\
 HYPRE_parcsr_fgmres.o\
 HYPRE_parcsr_lsicg.o\
 HYPRE_parcsr_symqmr.o\
 SymQMR.o\
 TFQmr.o\
 cfei_hypre.o\
 fgmres.o\
 hypre_lsi_amge.o\
 hypre_lsi_ddamg.o\
 hypre_lsi_misc.o\
 hypre_schur_reduce.o\
 hypre_slide_reduce.o\
 lsicg.o\
 LLNL_FEI_Fei.o\
 LLNL_FEI_Impl.o\
 LLNL_FEI_LSCore.o\
 LLNL_FEI_Matrix.o\
 LLNL_FEI_Solver.o\
 mli_utils.o\
 mli_amgsa_calib.o\
 mli_amgsa_coarsen1.o\
 mli_amgsa_dd_fedata.o\
 mli_amgsa_dd_sfei.o\
 mli_method.o\
 mli_method_amgcr.o\
 mli_method_amgrs.o\
 mli_method_amgsa.o\
 mli.o\
 mli_oneLevel.o\
 cmli.o\
 mli_febase.o\
 mli_fedata.o\
 mli_fedata_utils.o\
 mli_sfei.o\
 mli_mapper.o\
 mli_matrix.o\
 mli_matrix_mult.o\
 mli_matrix_utils.o\
 mli_solver.o\
 mli_solver_arpacksuperlu.o\
 mli_solver_bjacobi.o\
 mli_solver_bsgs.o\
 mli_solver_cg.o\
 mli_solver_chebyshev.o\
 mli_solver_gmres.o\
 mli_solver_gs.o\
 mli_solver_hschwarz.o\
 mli_solver_hsgs.o\
 mli_solver_jacobi.o\
 mli_solver_kaczmarz.o\
 mli_solver_mls.o\
 mli_solver_parasails.o\
 mli_solver_seqsuperlu.o\
 mli_solver_sgs.o\
 mli_solver_superlu.o\
 mli_vector.o\
 mli_utils_fortran.o\
 F90_HYPRE_IJMatrix.o\
 F90_HYPRE_IJVector.o\
 F90_IJMatrix.o\
 HYPRE_IJMatrix.o\
 HYPRE_IJVector.o\
 IJMatrix.o\
 IJMatrix_parcsr.o\
 IJVector.o\
 IJVector_parcsr.o\
 aux_parcsr_matrix.o\
 aux_par_vector.o\
 Euclid_apply.o\
 Euclid_dh.o\
 ExternalRows_dh.o\
 Factor_dh.o\
 Hash_dh.o\
 Hash_i_dh.o\
 MatGenFD.o\
 Mat_dh.o\
 Mem_dh.o\
 Numbering_dh.o\
 Parser_dh.o\
 SortedList_dh.o\
 SortedSet_dh.o\
 SubdomainGraph_dh.o\
 TimeLog_dh.o\
 Timer_dh.o\
 Vec_dh.o\
 blas_dh.o\
 getRow_dh.o\
 globalObjects.o\
 ilu_mpi_bj.o\
 ilu_mpi_pilu.o\
 ilu_seq.o\
 io_dh.o\
 krylov_dh.o\
 mat_dh_private.o\
 shellSort_dh.o\
 sig_dh.o\
 ConjGrad.o\
 DiagScale.o\
 FlexGmres.o\
 Hash.o\
 LoadBal.o\
 Matrix.o\
 Mem.o\
 Numbering.o\
 OrderStat.o\
 ParaSails.o\
 PrunedRows.o\
 RowPatt.o\
 StoredRows.o\
 hypre_ParaSails.o\
 comm.o\
 HYPRE_DistributedMatrixPilutSolver.o\
 debug.o\
 distributed_qsort.o\
 distributed_qsort_si.o\
 ilut.o\
 parilut.o\
 parutil.o\
 pblas1.o\
 serilut.o\
 trifactor.o\
 util.o\
 HYPRE_distributed_matrix.o\
 distributed_matrix.o\
 distributed_matrix_ISIS.o\
 distributed_matrix_PETSc.o\
 distributed_matrix_parcsr.o\
 HYPRE_bicgstab.o\
 HYPRE_cgnr.o\
 HYPRE_gmres.o\
 HYPRE_pcg.o\
 bicgstab.o\
 cgnr.o\
 gmres.o\
 pcg.o\
 HYPRE_ConvertPETScMatrixToDistributedMatrix.o\
 HYPRE_ConvertParCSRMatrixToDistributedMatrix.o\
 HYPRE_lobpcg.o\
 lobpcg.o\
 multivector.o\
 temp_multivector.o\
 HYPRE_parcsr_int.o\
 HYPRE_struct_int.o\
 HYPRE_sstruct_int.o\
 fortran_matrix.o\
 F90_HYPRE_parcsr_ParaSails.o\
 F90_HYPRE_parcsr_amg.o\
 F90_HYPRE_parcsr_bicgstab.o\
 F90_HYPRE_parcsr_cgnr.o\
 F90_HYPRE_parcsr_gmres.o\
 F90_HYPRE_parcsr_pcg.o\
 F90_HYPRE_parcsr_pilut.o\
 F90_hypre_laplace.o\
 HYPRE_parcsr_Euclid.o\
 HYPRE_parcsr_ParaSails.o\
 HYPRE_parcsr_amg.o\
 HYPRE_parcsr_bicgstab.o\
 HYPRE_parcsr_cgnr.o\
 HYPRE_parcsr_gmres.o\
 HYPRE_parcsr_hybrid.o\
 HYPRE_parcsr_pcg.o\
 HYPRE_parcsr_pilut.o\
 HYPRE_parcsr_schwarz.o\
 amg_hybrid.o\
 par_amg.o\
 par_amg_setup.o\
 par_amg_solve.o\
 par_amg_solveT.o\
 par_cg_relax_wt.o\
 par_coarse_parms.o\
 par_coarsen.o\
 par_cycle.o\
 par_difconv.o\
 par_gsmg.o\
 par_indepset.o\
 par_interp.o\
 par_laplace.o\
 par_laplace_27pt.o\
 par_laplace_9pt.o\
 par_nodal_systems.o\
 par_rap.o\
 par_rap_communication.o\
 par_relax.o\
 par_relax_interface.o\
 par_scaled_matnorm.o\
 par_schwarz.o\
 par_stats.o\
 par_strength.o\
 pcg_par.o\
 schwarz.o\
 F90_HYPRE_parcsr_matrix.o\
 F90_HYPRE_parcsr_vector.o\
 F90_par_vector.o\
 F90_parcsr_matrix.o\
 HYPRE_parcsr_matrix.o\
 HYPRE_parcsr_vector.o\
 communicationT.o\
 numbers.o\
 par_csr_aat.o\
 par_csr_bool_matop.o\
 par_csr_bool_matrix.o\
 par_csr_communication.o\
 par_csr_matop.o\
 par_csr_matrix.o\
 par_csr_matvec.o\
 par_vector.o\
 HYPRE_csr_matrix.o\
 HYPRE_mapped_matrix.o\
 HYPRE_vector.o\
 HYPRE_multiblock_matrix.o\
 csr_matop.o\
 csr_matrix.o\
 csr_matvec.o\
 genpart.o\
 mapped_matrix.o\
 multiblock_matrix.o\
 vector.o\
 HYPRE_sstruct_bicgstab.o\
 HYPRE_sstruct_gmres.o\
 HYPRE_sstruct_pcg.o\
 HYPRE_sstruct_split.o\
 HYPRE_sstruct_sys_pfmg.o\
 krylov.o\
 krylov_sstruct.o\
 node_relax.o\
 sys_pfmg.o\
 sys_pfmg_relax.o\
 sys_pfmg_setup.o\
 sys_pfmg_setup_interp.o\
 sys_pfmg_setup_rap.o\
 sys_pfmg_solve.o\
 sys_semi_interp.o\
 sys_semi_restrict.o\
 HYPRE_sstruct_graph.o\
 HYPRE_sstruct_grid.o\
 HYPRE_sstruct_matrix.o\
 HYPRE_sstruct_stencil.o\
 HYPRE_sstruct_vector.o\
 box_map.o\
 sstruct_axpy.o\
 sstruct_copy.o\
 sstruct_graph.o\
 sstruct_grid.o\
 sstruct_innerprod.o\
 sstruct_matrix.o\
 sstruct_matvec.o\
 sstruct_scale.o\
 sstruct_stencil.o\
 sstruct_vector.o\
 F90_HYPRE_struct_hybrid.o\
 F90_HYPRE_struct_pcg.o\
 F90_HYPRE_struct_pfmg.o\
 F90_HYPRE_struct_smg.o\
 HYPRE_struct_bicgstab.o\
 HYPRE_struct_gmres.o\
 HYPRE_struct_hybrid.o\
 HYPRE_struct_jacobi.o\
 HYPRE_struct_pcg.o\
 HYPRE_struct_pfmg.o\
 HYPRE_struct_smg.o\
 HYPRE_struct_sparse_msg.o\
 coarsen.o\
 cyclic_reduction.o\
 general.o\
 hybrid.o\
 jacobi.o\
 pcg_struct.o\
 pfmg.o\
 pfmg2_setup_rap.o\
 pfmg3_setup_rap.o\
 pfmg_relax.o\
 pfmg_setup.o\
 pfmg_setup_interp.o\
 pfmg_setup_rap.o\
 pfmg_setup_rap5.o\
 pfmg_setup_rap7.o\
 pfmg_solve.o\
 point_relax.o\
 semi_interp.o\
 semi_restrict.o\
 semi_setup_rap.o\
 smg.o\
 smg2_setup_rap.o\
 smg3_setup_rap.o\
 smg_axpy.o\
 smg_relax.o\
 smg_residual.o\
 smg_setup.o\
 smg_setup_interp.o\
 smg_setup_rap.o\
 smg_setup_restrict.o\
 smg_solve.o\
 sparse_msg.o\
 sparse_msg2_setup_rap.o\
 sparse_msg3_setup_rap.o\
 sparse_msg_filter.o\
 sparse_msg_interp.o\
 sparse_msg_restrict.o\
 sparse_msg_setup.o\
 sparse_msg_setup_rap.o\
 sparse_msg_solve.o\
 F90_HYPRE_struct_grid.o\
 F90_HYPRE_struct_matrix.o\
 F90_HYPRE_struct_stencil.o\
 F90_HYPRE_struct_vector.o\
 HYPRE_struct_grid.o\
 HYPRE_struct_matrix.o\
 HYPRE_struct_stencil.o\
 HYPRE_struct_vector.o\
 box.o\
 box_algebra.o\
 box_alloc.o\
 box_boundary.o\
 box_neighbors.o\
 grow.o\
 communication_info.o\
 computation.o\
 project.o\
 struct_axpy.o\
 struct_communication.o\
 struct_copy.o\
 struct_grid.o\
 struct_io.o\
 struct_innerprod.o\
 struct_matrix.o\
 struct_matrix_mask.o\
 struct_matvec.o\
 struct_scale.o\
 struct_stencil.o\
 struct_vector.o\
 amg_linklist.o\
 binsearch.o\
 hypre_memory.o\
 hypre_qsort.o\
 memory_dmalloc.o\
 mpistubs.o\
 qsplit.o\
 random.o\
 thread_mpistubs.o\
 threading.o\
 timer.o\
 timing.o\
 umalloc_local.o

FILES = \
 $(BLASFILES)\
 $(LAPACKFILES)\
 $(SUPERLUFILES)\
 $(MOSTFILES)

FILES_LSI = $(MOSTFILES)

##################################################################
# Targets
##################################################################

all:
	@\
	for dir in ${HYPRE_SRC_DIRS}; \
	do \
	   for file in ../$$dir/*.o; \
	   do \
	      (cp -f $$file .); \
	   done; \
	done

install: all libHYPRE.a libHYPRE_LSI.a
	@cp -f libHYPRE* ../hypre/lib

clean:
	@rm -f *.o 

veryclean: clean
	@rm -f lib*.a


##################################################################
# Rules
##################################################################

libHYPRE.a: ${FILES}
	@echo  "Building $@ ... "
	ar -rcu $@ ${FILES}
	${RANLIB} $@

libHYPRE_LSI.a: ${FILES_LSI}
	@echo  "Building $@ ... "
	ar -rcu $@ ${FILES_LSI}
	${RANLIB} $@
